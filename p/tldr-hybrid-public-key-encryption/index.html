<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='A new standardized way to do hybrid public key encryption.'><title>TL;DR - Hybrid Public Key Encryption</title>

<link rel='canonical' href='https://www.franziskuskiefer.de/p/tldr-hybrid-public-key-encryption/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='TL;DR - Hybrid Public Key Encryption'>
<meta property='og:description' content='A new standardized way to do hybrid public key encryption.'>
<meta property='og:url' content='https://www.franziskuskiefer.de/p/tldr-hybrid-public-key-encryption/'>
<meta property='og:site_name' content='Dr Franziskus Kiefer'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='tl;dr' /><meta property='article:tag' content='hpke' /><meta property='article:tag' content='ietf' /><meta property='article:tag' content='Cryspen' /><meta property='article:published_time' content='2022-02-24T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2022-02-24T00:00:00&#43;00:00'/><meta property='og:image' content='https://www.franziskuskiefer.de/p/tldr-hybrid-public-key-encryption/hybrid.jpg' />
<meta name="twitter:site" content="@_franziskus_">
    <meta name="twitter:creator" content="@_franziskus_"><meta name="twitter:title" content="TL;DR - Hybrid Public Key Encryption">
<meta name="twitter:description" content="A new standardized way to do hybrid public key encryption."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://www.franziskuskiefer.de/p/tldr-hybrid-public-key-encryption/hybrid.jpg' />
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="https://www.franziskuskiefer.de/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/tldr-hybrid-public-key-encryption/">
                <img src="/p/tldr-hybrid-public-key-encryption/hybrid_hu08cb25aae405155d9080e0a0f66756a3_268000_800x0_resize_q75_box.jpg"
                        srcset="/p/tldr-hybrid-public-key-encryption/hybrid_hu08cb25aae405155d9080e0a0f66756a3_268000_800x0_resize_q75_box.jpg 800w, /p/tldr-hybrid-public-key-encryption/hybrid_hu08cb25aae405155d9080e0a0f66756a3_268000_1600x0_resize_q75_box.jpg 1600w"
                        width="800" 
                        height="466" 
                        loading="lazy"
                        alt="Featured image of post TL;DR - Hybrid Public Key Encryption" />
                
            </a>
        </div>
    

    <div class="article-details">
    

    <h2 class="article-title">
        <a href="/p/tldr-hybrid-public-key-encryption/">TL;DR - Hybrid Public Key Encryption</a>
    </h2>

    
    <h3 class="article-subtitle">
        A new standardized way to do hybrid public key encryption.
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Feb 24, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    7 min read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <p><a class="link" href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-hpke/"  target="_blank" rel="noopener"
    >HPKE</a> is a <a class="link" href="https://datatracker.ietf.org/rg/cfrg/about/"  target="_blank" rel="noopener"
    >CFRG</a> in <a class="link" href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-hpke/"  target="_blank" rel="noopener"
    >RFC 9180</a> that describes a scheme for hybrid public key encryption.
It is co-authored by my <a class="link" href="https://www.cryspen.com"  target="_blank" rel="noopener"
    >Cryspen</a> co-founder <a class="link" href="https://bhargavan.info/index.html"  target="_blank" rel="noopener"
    >Karthikeyan Bhargavan</a> and one of
his PhD students <a class="link" href="https://www.benjaminlipp.de"  target="_blank" rel="noopener"
    >Benjamin Lipp</a> as part of his research at <a class="link" href="https://team.inria.fr/prosecco"  target="_blank" rel="noopener"
    >Inria</a>.</p>
<p>This blog post will give a brief overview of the specification and describes some use cases.</p>
<p>If you want to learn more about the security proofs behind HPKE and the RFC process,
Benjamin wrote an <a class="link" href="https://www.benjaminlipp.de/p/hpke-cryptographic-standard/"  target="_blank" rel="noopener"
    >excellent blog post</a> about it.</p>
<p>Hybrid Public Key Encryption, or short HPKE, is a cyrptographic mechanism that
allows encrypting payload to a public key.
It is called &ldquo;hybrid&rdquo; because the payload is encrypted with a symmetric scheme.
The symmetric key is then encrypted to the receivers public key.
The <a class="link" href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-hpke/"  target="_blank" rel="noopener"
    >HPKE</a> standard defines a number of natural extensions to the basic setting
that allow the sender to authenticate themselves.</p>
<h2 id="hybrid-crypto-systems">Hybrid Crypto Systems</h2>
<p>Hybrid public key encryption has been used in different ways since the early 1990s in protocols such as <a class="link" href="https://en.wikipedia.org/wiki/Pretty_Good_Privacy"  target="_blank" rel="noopener"
    >PGP</a> or <a class="link" href="https://en.wikipedia.org/wiki/Cryptographic_Message_Syntax"  target="_blank" rel="noopener"
    >SMIME</a>.
While these two protocols are for a very specific use case a more general version of hybrid encryption is described in <a class="link" href="https://en.wikipedia.org/wiki/Integrated_Encryption_Scheme"  target="_blank" rel="noopener"
    >ECIES</a>.
<a class="link" href="https://en.wikipedia.org/wiki/Integrated_Encryption_Scheme"  target="_blank" rel="noopener"
    >ECIES</a> is part of many systems nowadays.
<a class="link" href="https://developer.apple.com/documentation/security/certificate_key_and_trust_services/keys/storing_keys_in_the_secure_enclave"  target="_blank" rel="noopener"
    >Storing keys in the secure enclave on an iOS</a> device for example uses <a class="link" href="https://en.wikipedia.org/wiki/Integrated_Encryption_Scheme"  target="_blank" rel="noopener"
    >ECIES</a>.</p>
<!-- For a deeper explanation and history of hybrid crypto systems I recommend reading
[Christopher Wood's blog post]. -->
<p>However, there&rsquo;s no general description of hybrid public key encryption with modern primitives.
The <a class="link" href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-hpke/"  target="_blank" rel="noopener"
    >HPKE</a> standard solves this issue.
Even before the RFC is finalised it is used in specifications for <a class="link" href="https://datatracker.ietf.org/doc/draft-ietf-tls-esni/"  target="_blank" rel="noopener"
    >ECH</a>, <a class="link" href="https://datatracker.ietf.org/doc/draft-ietf-mls-protocol/"  target="_blank" rel="noopener"
    >MLS</a>, <a class="link" href="https://datatracker.ietf.org/doc/draft-pauly-dprive-oblivious-doh/"  target="_blank" rel="noopener"
    >ODOH</a>, and <a class="link" href="https://datatracker.ietf.org/doc/draft-gpew-priv-ppm/"  target="_blank" rel="noopener"
    >PPM</a>.
This shows the high demand for <a class="link" href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-hpke/"  target="_blank" rel="noopener"
    >HPKE</a>.</p>
<p>HPKE has four distinct modes of operation: Base, Auth, PSK, AuthPSK.
In this blog post we only describe the two most commonly used modes Base and Auth.</p>
<p><strong>HPKE Modes</strong></p>
<p>The <em>Base</em> mode is the most common use case for HPKE where payload is encrypted
to a public key.
All other modes are authenticated in different ways.</p>
<ul>
<li><em>Auth</em> uses the sender&rsquo;s private key for authentication</li>
<li><em>PSK</em> uses a pre-shared, high-entropy, key for authentication</li>
<li><em>AuthPSK</em> uses the sender&rsquo;s private key as well as a pre-shared, high-entropy, key for authentication</li>
</ul>
<h3 id="encrypting-to-a-public-key">Encrypting to a public key</h3>
<p>The following figure depicts the general flow of encrypting to a public key.
This is the Base mode in HPKE.
This is the most basic application of hybrid crypto systems.
Alex knows the public key from Sasha and wants to send some <code>Data</code> to them.
Shasha&rsquo;s public key is used to encrypt a shared secret, which is used to encrypt
the <code>Data</code>.
The encrypted shared secret as well as the encrypted data is sent to Sasha, who
can retrieve the shared secret with their corresponding private key.</p>
<p><figure style="flex-grow: 99; flex-basis: 238px">
		<a href="/p/tldr-hybrid-public-key-encryption/hybrid-encryption.png" data-size="1229x1237"><img src="/p/tldr-hybrid-public-key-encryption/hybrid-encryption.png"
				srcset="/p/tldr-hybrid-public-key-encryption/hybrid-encryption_hu0ec71786f79143a99e1764e382ce63cf_316986_480x0_resize_box_3.png 480w, /p/tldr-hybrid-public-key-encryption/hybrid-encryption_hu0ec71786f79143a99e1764e382ce63cf_316986_1024x0_resize_box_3.png 1024w"
				width="1229"
				height="1237"
				loading="lazy"
				>
		</a>
		
	</figure></p>
<h3 id="encrypting-to-a-public-key--authenticating-with-an-asymmetric-key">Encrypting to a public key &amp; Authenticating with an asymmetric key</h3>
<p>Sometimes it is useful or necessary to authenticate the sender of the data.
This is depicted in the figure below and represents the HPKE Auth mode.
The authentication is achieved by mixing in the sender&rsquo;s private key such that
the receiver will only retrieve the correct shared secret if the public key
they use for the sender corresponds to the used private key.</p>
<p><figure style="flex-grow: 118; flex-basis: 285px">
		<a href="/p/tldr-hybrid-public-key-encryption/authenticated-hybrid-encryption.png" data-size="1470x1237"><img src="/p/tldr-hybrid-public-key-encryption/authenticated-hybrid-encryption.png"
				srcset="/p/tldr-hybrid-public-key-encryption/authenticated-hybrid-encryption_hu2a8758be36ffa4ce890f3eb2a453dd08_355212_480x0_resize_box_3.png 480w, /p/tldr-hybrid-public-key-encryption/authenticated-hybrid-encryption_hu2a8758be36ffa4ce890f3eb2a453dd08_355212_1024x0_resize_box_3.png 1024w"
				width="1470"
				height="1237"
				loading="lazy"
				>
		</a>
		
	</figure></p>
<h2 id="hpke">HPKE</h2>
<p><a class="link" href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-hpke/"  target="_blank" rel="noopener"
    >HPKE</a> is essentially standardising how to use <a class="link" href="https://en.wikipedia.org/wiki/Key_encapsulation"  target="_blank" rel="noopener"
    >Key Encapsulation Mechanisms (KEM)</a>
for hybrid encryption.
The sender in <a class="link" href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-hpke/"  target="_blank" rel="noopener"
    >HPKE</a> uses a KEM to generate the shared secret as well as the
encapsulation.
The shared secret is then used in an <a class="link" href="https://en.wikipedia.org/wiki/Authenticated_encryption#Authenticated_encryption_with_associated_data_%28AEAD%29"  target="_blank" rel="noopener"
    >AEAD</a> (after running it through a key schedule)
in order to encrypt a payload.</p>
<p>All HPKE use cases so far only take advantage of the single-shot APIs from HPKE.
In order to encrypt a payload to a public key the sender needs to provide the
receiver&rsquo;s public key <code>pkR</code>, some information <code>info</code> and additional data <code>aad</code> to bind the encryption
to a certain context, as well as the payload <code>pt</code>.
HPKE returns the cipher text <code>ct</code> as well as the encapsulation <code>enc</code> that are both sent to
the receiver.</p>
<pre tabindex="0"><code>enc, ct &lt;- Seal(pkR, info, aad, pt)
</code></pre><p>When using the Auth mode the sender&rsquo;s private key <code>sk</code> is needed in addition.</p>
<p>The receiver takes the encapsulation <code>enc</code> and cipher text <code>ct</code> together with their
private key to retrieve the payload.</p>
<pre tabindex="0"><code>pt &lt;- Open(enc, skR, info, aad, ct)
</code></pre><p>When using the Auth mode the sender&rsquo;s public key <code>pkS</code> is needed in addition.</p>
<h3 id="multiple-encryptions">Multiple Encryptions</h3>
<p>HPKE allows multiple encryptions with the same shared secret.
This is favourable if multiple messages are sent from the sender to the receiver.
To this end HPKE generates a context that allows encrypting (and decrypting) multiple
messages.</p>
<pre tabindex="0"><code>enc, ContextS &lt;- SetupS(pkR, info)
ContextR &lt;- SetupR(enc, skR, info)
</code></pre><p>Note that HPKE goes a step further than the <a class="link" href="https://datatracker.ietf.org/doc/html/rfc5116"  target="_blank" rel="noopener"
    >AEAD RFC</a> and simplifies the API.
The consumer only needs to provide the payload and (potentially empty) additional
data.
HPKE takes care of providing unique nonces to the AEAD and fails if the maximum
number of encryptions with the context have been performed &mdash; in particular if
the nonce would overflow.</p>
<pre tabindex="0"><code>ct &lt;- ContextS.Seal(aad, pt)
pt &lt;- ContextR.Open(aad, ct)
</code></pre><h3 id="exporting-secrets">Exporting Secrets</h3>
<p>In some scenarios applications need to establish additional shared secrets.
This can be achieved with the HPKE exporter interface.
The API is similar to the <code>Seal</code> and <code>Open</code> functions above but don&rsquo;t require
a payload or additional data.
Instead an <code>exporter_context</code> and the length of the exported secret <code>L</code> have to
be provided.</p>
<pre tabindex="0"><code>enc, exported_secret &lt;- SendExport(pkR, info, exporter_context, L)
exported_secret &lt;- ReceiveExport(enc, skR, info, exporter_context, L)
</code></pre><h3 id="use-cases">Use Cases</h3>
<p>Instead of inventing new use cases for HPKE we describe how HPKE is used in <a class="link" href="https://datatracker.ietf.org/doc/draft-ietf-mls-protocol/"  target="_blank" rel="noopener"
    >MLS</a>
and <a class="link" href="https://datatracker.ietf.org/doc/draft-ietf-tls-esni/"  target="_blank" rel="noopener"
    >ECH</a> as they reflect common uses of hybrid public key encryption.</p>
<h4 id="hpke-in-mls">HPKE in MLS</h4>
<p><a class="link" href="https://datatracker.ietf.org/doc/draft-ietf-mls-protocol/"  target="_blank" rel="noopener"
    >MLS</a> (Message Layer Security) is an IETF draft that standardises a new way of efficiently encrypting messages
between participants in groups.
It aims to solve the problem of end-to-end encryption in instant messaging.
<a class="link" href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-hpke/"  target="_blank" rel="noopener"
    >HPKE</a> is a core building block.
In order to encrypt a message to a specific entity in the protocol, <a class="link" href="https://datatracker.ietf.org/doc/draft-ietf-mls-protocol/"  target="_blank" rel="noopener"
    >MLS</a> uses <a class="link" href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-hpke/"  target="_blank" rel="noopener"
    >HPKE</a>
to encrypt the message to the specific public key.</p>
<h4 id="hpke-in-ech">HPKE in ECH</h4>
<p><a class="link" href="https://datatracker.ietf.org/doc/draft-ietf-tls-esni/"  target="_blank" rel="noopener"
    >ECH</a> (Encrypted Client Hello) is a mechanism in <a class="link" href="https://tools.ietf.org/html/rfc8446"  target="_blank" rel="noopener"
    >TLS</a> (Transport Layer Security)
for encrypting a ClientHello message under a server public key.
This description from the <a class="link" href="https://datatracker.ietf.org/doc/draft-ietf-tls-esni/"  target="_blank" rel="noopener"
    >ECH</a> draft corresponds directly to the Base mode of <a class="link" href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-hpke/"  target="_blank" rel="noopener"
    >HPKE</a>
as described above.
This allows <a class="link" href="https://tools.ietf.org/html/rfc8446"  target="_blank" rel="noopener"
    >TLS</a> connections to become more private because they don&rsquo;t leak
information about the connection, in particular the exact server the client wants
to connect to.</p>
<h2 id="demo">Demo</h2>
<p>In order to better understand the message flow and working of HPKE we put together
an interactive demo below to demonstrate how HPKE works.</p>
<ol>
<li>First generate a key pair for the receiver.</li>
<li>Then populate the info, additional data, and payload fields on the sender side.</li>
<li>When clicking the &ldquo;HPKE Seal&rdquo; button on the sender the following happens</li>
</ol>
<ul>
<li>The sender retrieves the public key from the receiver that has been generated in the first step.</li>
<li>The sender uses HPKE to encrypt the payload together with the info and additional data to the receiver&rsquo;s public key.</li>
<li>The result is written into the Encoded Shared Secret and Ciphertext fields.</li>
</ul>
<ol start="4">
<li>When clicking &ldquo;HPKE Open&rdquo; the receiver uses the private key to retrieve the shared secret and decrypt the ciphertext.
The &ldquo;Info&rdquo; and &ldquo;Additional Data&rdquo; are the same as entered on the sender&rsquo;s side.</li>
</ol>
<h3 id="try-it-out-now">Try it out now!</h3>
<iframe width="100%" height="800px" src="./hpke_demo/index.html"></iframe>
<p>The demo is written in <a class="link" href="https://hacspec.org"  target="_blank" rel="noopener"
    >hacspec</a> (a subset of Rust) with a <a class="link" href="https://webassembly.org/"  target="_blank" rel="noopener"
    >WASM</a> frontend.
Please stay tuned for a follow-up blog post diving into the details of this implementation.</p>
<h2 id="summary">Summary</h2>
<p><a class="link" href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-hpke/"  target="_blank" rel="noopener"
    >HPKE</a> is a simple, but very powerful new tool that allows to efficiently solve
key distribution problems (see the MLS use case) as well as increase privacy
in existing protocols (see the ECH use case).</p>
<p>My company <a class="link" href="https://www.cryspen.com"  target="_blank" rel="noopener"
    >Cryspen</a> offers support for using <a class="link" href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-hpke/"  target="_blank" rel="noopener"
    >HPKE</a> as well as high assurance implementations
of HPKE and other protocols.
<a class="link" href="mailto:franziskus@cryspen.com" >Get in touch for more information.</a></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/tldr/">tl;dr</a>
        
            <a href="/tags/hpke/">hpke</a>
        
            <a href="/tags/ietf/">ietf</a>
        
            <a href="/tags/cryspen/">Cryspen</a>
        
    </section>


    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/p/an-executable-hpke-specification/">
        
        
            <div class="article-image">
                <img src="/p/an-executable-hpke-specification/header.86420444a531dfec7e13c87824c29d1b_hu4cb9b0bb4d1bfca6e45e87162bd8ddf2_355178_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-hkIERKUx3&#43;x&#43;E8h4JMKdGw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">An Executable HPKE Specification</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
     
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2013 - 
        
        2022 Dr Franziskus Kiefer
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.1.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ol>
    <li><a href="#hybrid-crypto-systems">Hybrid Crypto Systems</a>
      <ol>
        <li><a href="#encrypting-to-a-public-key">Encrypting to a public key</a></li>
        <li><a href="#encrypting-to-a-public-key--authenticating-with-an-asymmetric-key">Encrypting to a public key &amp; Authenticating with an asymmetric key</a></li>
      </ol>
    </li>
    <li><a href="#hpke">HPKE</a>
      <ol>
        <li><a href="#multiple-encryptions">Multiple Encryptions</a></li>
        <li><a href="#exporting-secrets">Exporting Secrets</a></li>
        <li><a href="#use-cases">Use Cases</a>
          <ol>
            <li><a href="#hpke-in-mls">HPKE in MLS</a></li>
            <li><a href="#hpke-in-ech">HPKE in ECH</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#demo">Demo</a>
      <ol>
        <li><a href="#try-it-out-now">Try it out now!</a></li>
      </ol>
    </li>
    <li><a href="#summary">Summary</a></li>
  </ol>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
