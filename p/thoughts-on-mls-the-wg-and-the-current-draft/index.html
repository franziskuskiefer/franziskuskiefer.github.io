<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='I recently sent an e-mail to the MLS working group with some comments on the draft. Because there appears to be little interest in improving the draft I want to use this post to elaborate on the issues I see with the draft an the working group.
This is an opinion piece.
MLS Let&amp;rsquo;s first recap on MLS. According to messaginglayersecurity.rocks the Messaging Layer Security (MLS)
 is a security layer for encrypting messages in groups of size two to many.'><title>Thoughts on MLS, the WG, and the current draft</title>

<link rel='canonical' href='https://www.franziskuskiefer.de/p/thoughts-on-mls-the-wg-and-the-current-draft/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='Thoughts on MLS, the WG, and the current draft'>
<meta property='og:description' content='I recently sent an e-mail to the MLS working group with some comments on the draft. Because there appears to be little interest in improving the draft I want to use this post to elaborate on the issues I see with the draft an the working group.
This is an opinion piece.
MLS Let&amp;rsquo;s first recap on MLS. According to messaginglayersecurity.rocks the Messaging Layer Security (MLS)
 is a security layer for encrypting messages in groups of size two to many.'>
<meta property='og:url' content='https://www.franziskuskiefer.de/p/thoughts-on-mls-the-wg-and-the-current-draft/'>
<meta property='og:site_name' content='Dr Franziskus Kiefer'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='ietf' /><meta property='article:tag' content='MLS' /><meta property='article:tag' content='opinion' /><meta property='article:published_time' content='2020-10-09T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2020-10-09T00:00:00&#43;00:00'/><meta property='og:image' content='https://www.franziskuskiefer.de/images/profilepic.jpg' />
<meta name="twitter:site" content="@_franziskus_">
    <meta name="twitter:creator" content="@_franziskus_"><meta name="twitter:title" content="Thoughts on MLS, the WG, and the current draft">
<meta name="twitter:description" content="I recently sent an e-mail to the MLS working group with some comments on the draft. Because there appears to be little interest in improving the draft I want to use this post to elaborate on the issues I see with the draft an the working group.
This is an opinion piece.
MLS Let&amp;rsquo;s first recap on MLS. According to messaginglayersecurity.rocks the Messaging Layer Security (MLS)
 is a security layer for encrypting messages in groups of size two to many."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://www.franziskuskiefer.de/images/profilepic.jpg' />
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="https://www.franziskuskiefer.de/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <h2 class="article-title">
        <a href="/p/thoughts-on-mls-the-wg-and-the-current-draft/">Thoughts on MLS, the WG, and the current draft</a>
    </h2>

    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Oct 09, 2020</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    4 min read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <p><em>I recently sent an <a class="link" href="https://mailarchive.ietf.org/arch/msg/mls/ZOy80Yp5bRhoM8fsQMGVwmFFEzY/"  target="_blank" rel="noopener"
    >e-mail</a> to the <a class="link" href="https://datatracker.ietf.org/wg/mls/about/"  target="_blank" rel="noopener"
    >MLS</a> working group with some comments on the draft.
Because there appears to be little interest in improving the draft I want to use this post to elaborate on the issues I see with the draft an the working group.</em></p>
<p>This is an opinion piece.</p>
<h2 id="mls">MLS</h2>
<p>Let&rsquo;s first recap on MLS.
According to <a class="link" href="https://messaginglayersecurity.rocks/"  target="_blank" rel="noopener"
    >messaginglayersecurity.rocks</a> the Messaging Layer Security (MLS)</p>
<blockquote>
<p>is a security layer for encrypting messages in groups of size two to many.</p>
</blockquote>
<p>It can be used to solve the issue of end-to-end encrypted (e2ee) group messaging
There are mainly two different approaches to e2ee group messaging.
Use pairwise one-to-one connections.
This is obviously very inefficient for larger groups.
Anyone who&rsquo;s used Signal or Wire with larger groups will have noticed this.
The other option is to use a single key for the entire group, which obviously comes with a number of security issues.</p>
<p>MLS is supposed to solve the issue by providing a way to negotiate keys with a large number of other clients that can be used for e2ee group messaging.</p>
<h2 id="the-working-group">The Working Group</h2>
<p>MLS is driven by the IETF MLS working group (WG).</p>
<p>As all IETF WGs communication should be done on the <a class="link" href="https://mailarchive.ietf.org/arch/browse/mls/"  target="_blank" rel="noopener"
    >mailing list</a>.</p>
<h2 id="state-of-the-draft">State of the draft</h2>
<p>While trying to implement the MLS protocol from scratch I ran into a couple
issues and I think there’s a general problem regarding the structure of the
draft. Note that these are all editorial issues.</p>
<p>Right now I see no straightforward way to implement the spec as there’s no
clear structure. To implement even the basic tree structure it’s necessary
to jump through the entire document. There’s also a lot of prose and
examples and very little implementable parts.</p>
<p>Let me give some examples:</p>
<p>Section 5 (Ratchet Trees) reads like a non-normative section (or paper).
The really interesting bit related to trees is in Appendix A. I suggest
moving the formal description of the tree from Appendix A to this section.
It’s impossible to implement this from the hand full examples here.</p>
<p>There’s no description in here on how the tree actually works. For example,
adding a node to the tree is defined in 10.1.1 (Add).</p>
<p>The ratchet tree nodes as described in Section 5 don&rsquo;t hold a KeyPackage.
But Section 7 says “As the KeyPackage is a structure which is stored in the
Ratchet Tree and updated depending on the evolution of this tree”.</p>
<p>The tree nodes have a parent hash field, which is of course part of the
ratchet tree but shouldn’t be necessary for the description of the tree
structure.</p>
<p>Also, the description of the tree hash (Section 7.5) follows the definition
of the parent_hash extension in Section 7.4 such that it is not entirely
clear which parent_hash is used there (extension or node value).</p>
<p>Section 5 also talks about commit messages without linking to them or
introducing them. Having to talk about commit messages in this section is
also a little confusing.</p>
<p>The term “handshake message” is first used in Section 7.8 (Key Schedule)
but never introduced. This should probably happen in 10 (Group Evolution),
which doesn’t talk about handshake messages at all until 10.3 (Ratchet Tree
Extension).</p>
<p>There are probably plenty more issues like this. But I don’t think
addressing any of these issues individually makes sense. I therefore
suggest having an overhaul of the document structure.</p>
<p>The way I see MLS there are a set of high-level structures and components
that should be clearly described and built upon each other. There’s a data
structure (tree) that is used to represent a group. Then there is the MLS
group that implements a specific semantic on the tree. Operations to modify
the group are specified in the handshake protocol. And application messages
define messages encrypted with keys derived in the handshake protocol with
the <em>key schedule</em>.</p>
<p>The tree is a basic left-balanced binary tree and defines functions to
create a tree, and add and remove nodes.</p>
<p>A group is the main part of MLS, a tree with nodes of a certain type. So
this part should describe what nodes look like and how the tree is used to
compute tree invariants and keys.</p>
<p>The handshake protocol defines all messages needed to perform operations on
the MLS group.</p>
<p>This is certainly not exhaustive and would need further refinement. But
it’s the high-level structure I’d expect from the document. I’m sure other
structures would work as well. But what we currently have isn’t what is
needed to implement MLS imho.</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/ietf/">ietf</a>
        
            <a href="/tags/mls/">MLS</a>
        
            <a href="/tags/opinion/">opinion</a>
        
    </section>


    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
</aside>

     
     
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2013 - 
        
        2022 Dr Franziskus Kiefer
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.1.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ol>
    <li><a href="#mls">MLS</a></li>
    <li><a href="#the-working-group">The Working Group</a></li>
    <li><a href="#state-of-the-draft">State of the draft</a></li>
  </ol>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
